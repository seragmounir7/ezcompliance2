<app-scroll></app-scroll>
<div
	class="btn btn-outline-primary"
	*ngIf="id ==='Form'"
	[routerLink]="['/admin/forms/fillConfigForm/'+0]"
>
	<i class="fa fa-arrow-left" aria-hidden="true"></i>
</div>
<div
	class="btn btn-outline-primary"
	*ngIf="!isHistory && id!=='Form' && type!=='Incident'"
	[routerLink]="['/admin/forms/incidentsTable']"
>
	<i class="fa fa-arrow-left" aria-hidden="true"></i>
</div>
<div
	class="btn btn-outline-primary"
	*ngIf="type==='Incident'"
	[routerLink]="['/admin/savedForms']"
>
	<i class="fa fa-arrow-left" aria-hidden="true"></i>
</div>
<div
	class="btn btn-outline-primary"
	*ngIf="isHistory"
	[routerLink]="returnTo | async"
>
	<i class="fa fa-arrow-left" aria-hidden="true"></i>
</div>

<div
	id="section-to-print"
	class="container card px-4 py-4"
	[class.px-3]="mobileViewService.isMobile| async"
	[class.disableDiv]="isHistory"
	[formGroup]="IncidentReport"
>
	<h2 class="text-center pt-3">
		<p>Accident Report Form</p>
	</h2>
	<hr />

	<p class="title">Site Information</p>

	<div class="box">
		<div class="row">
			<div class="col col-md col-sm-6-print form-floating">
				<select
					class="form-select form-control"
					aria-label="Default select example"
					formControlName="jobNumber"
					placeholder="dd"
					(change)="jobNoSel()"
					[class.is-invalid]="
            IncidentReport.get('jobNumber')?.hasError('required') &&
            (IncidentReport.get('jobNumber').dirty ||
              IncidentReport.get('jobNumber').touched)
          "
				>
					<label class="cols" class="form-Label">Job Number</label>
					<option selected hidden>
						Select<span class="text-danger">*</span>
					</option>
					<option
						[value]="jobNo._id"
						*ngFor="let jobNo of allJobNumbers"
					>
						{{ jobNo.jobNumber }}
					</option>
				</select>
				<label class="form-label mb-3"
					>Job Number<span class="text-danger">*</span></label
				>
				<span
					*ngIf="
            IncidentReport.get('jobNumber')?.hasError('required') &&
            (IncidentReport.get('jobNumber').dirty ||
              IncidentReport.get('jobNumber').touched)
          "
					class="invalid-feedback"
				>
					Job Number is Required</span
				>
			</div>
			<!-- <div class="col-md-6 col-sm-6-print">
				<div>
					<label class="cols" class="form-Label"
						>Project Name<span class="text-danger">*</span></label
					>
					<input
						type="text"
						formControlName="projectName"
						class="form-control"
						[class.is-invalid]="
              IncidentReport.get('projectName')?.hasError('required') &&
              (IncidentReport.get('projectName').dirty ||
                IncidentReport.get('projectName').touched)
            "
					/>
					<span
						*ngIf="
              IncidentReport.get('projectName')?.hasError('required') &&
              (IncidentReport.get('projectName').dirty ||
                IncidentReport.get('projectName').touched)
            "
						class="invalid-feedback"
					>
						Project Name is Required</span
					>
				</div>
			</div> -->
		</div>
		<div class="row">
			<div class="col-md-6 col-sm-6-print">
				<div class="form-floating">
					<input
						type="text"
						class="form-control"
						placeholder="dd"
						formControlName="siteName"
						[class.is-invalid]="
              IncidentReport.get('siteName')?.hasError('required') &&
              (IncidentReport.get('siteName').dirty ||
                IncidentReport.get('siteName').touched)
            "
					/>
					<label class="cols" class="form-Label"
						>Site Name<span class="text-danger">*</span></label
					>
					<span
						*ngIf="
              IncidentReport.get('siteName')?.hasError('required') &&
              (IncidentReport.get('siteName').dirty ||
                IncidentReport.get('siteName').touched)
            "
						class="invalid-feedback"
					>
						Site Name is Required</span
					>
				</div>
			</div>
			<div class="col-md-6 col-sm-6-print">
				<div class="form-floating">
					<input
						type="text"
						class="form-control"
						placeholder="dd"
						formControlName="customerName"
						[class.is-invalid]="
              IncidentReport.get('customerName')?.hasError('required') &&
              (IncidentReport.get('customerName').dirty ||
                IncidentReport.get('customerName').touched)
            "
					/>
					<label class="cols" class="form-Label"
						>Customer Name<span class="text-danger">*</span></label
					>
					<span
						*ngIf="
              IncidentReport.get('customerName')?.hasError('required') &&
              (IncidentReport.get('customerName').dirty ||
                IncidentReport.get('customerName').touched)
            "
						class="invalid-feedback"
					>
						Customer Name is Required</span
					>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-sm-6-print">
				<div class="form-floating">
					<textarea
						autosize
						type="text"
						placeholder="dd"
						formControlName="streetAddress"
						class="form-control"
						id="name"
						[class.is-invalid]="
              IncidentReport.get('streetAddress')?.hasError('required') &&
              (IncidentReport.get('streetAddress').dirty ||
                IncidentReport.get('streetAddress').touched)
            "
					></textarea>
					<label class="cols" class="form-Label"
						>Site Address<span class="text-danger">*</span></label
					>
					<span
						*ngIf="
              IncidentReport.get('streetAddress')?.hasError('required') &&
              (IncidentReport.get('streetAddress').dirty ||
                IncidentReport.get('streetAddress').touched)
            "
						class="invalid-feedback"
					>
						Site Address is Required</span
					>
				</div>
			</div>
			<div class="col-md-6 col-sm-6-print">
				<div class="form-floating">
					<input
						placeholder=""
						type="text"
						placeholder="dd"
						class="form-control"
						formControlName="customerContact"
						[class.is-invalid]="
              IncidentReport.get('customerContact')?.hasError('required') &&
              (IncidentReport.get('customerContact').dirty ||
                IncidentReport.get('customerContact').touched)
            "
					/>
					<label class="cols" class="form-Label"
						>Customer Contact<span class="text-danger"
							>*</span
						></label
					>
					<span
						*ngIf="
              IncidentReport.get('customerContact')?.hasError('required') &&
              (IncidentReport.get('customerContact').dirty ||
                IncidentReport.get('customerContact').touched)
            "
						class="invalid-feedback"
					>
						Customer Contact is Required</span
					>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-sm-6-print form-floating">
				<select
					class="form-select form-control col"
					placeholder="dd"
					aria-label="Default select example"
					formControlName="projectManager"
					[class.is-invalid]="
            IncidentReport.get('projectManager')?.hasError('required') &&
            (IncidentReport.get('projectManager').dirty ||
              IncidentReport.get('projectManager').touched)
          "
				>
					<option selected hidden>
						Select<span class="text-danger">*</span>
					</option>
					<option [value]="mang._id" *ngFor="let mang of empData">
						{{ mang.fullName }}
					</option>
				</select>
				<label class="form-label mb-3"
					>Project Manager<span class="text-danger">*</span></label
				>
				<span
					*ngIf="
            IncidentReport.get('projectManager')?.hasError('required') &&
            (IncidentReport.get('projectManager').dirty ||
              IncidentReport.get('projectManager').touched)
          "
					class="invalid-feedback"
				>
					Project Manager is Required</span
				>
			</div>

			<div class="col-md-6 col-sm-6-print">
				<div class="form-floating">
					<input
						type="text"
						placeholder="dd"
						[matAutocomplete]="personCompletingForm"
						class="form-control"
						formControlName="personCompletingForm"
						[class.is-invalid]="
              IncidentReport.get('personCompletingForm')?.hasError(
                'required'
              ) &&
              (IncidentReport.get('personCompletingForm').dirty ||
                IncidentReport.get('personCompletingForm').touched)
            "
					/>
					<label class="cols" class="form-Label"
						>Person Completing Form
						<span class="text-danger">*</span></label
					>
					<mat-autocomplete
						#personCompletingForm="matAutocomplete"
						(optionSelected)="employeeData($event,'personCompletingForm')"
						[displayWith]="displayFn"
					>
						<mat-option
							*ngFor="let option of personCompletingForm$ | async ; let i = index "
							[value]="option"
						>
							{{option.fullName}}
						</mat-option>
					</mat-autocomplete>
					<span
						*ngIf="
              IncidentReport.get('personCompletingForm')?.hasError(
                'required'
              ) &&
              (IncidentReport.get('personCompletingForm').dirty ||
                IncidentReport.get('personCompletingForm').touched)
            "
						class="invalid-feedback"
					>
						This Field is Required</span
					>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-sm-6-print">
				<div class="form-floating">
					<input
						placeholder="(000) 000-0000"
						type="text"
						placeholder="dd"
						class="form-control"
						formControlName="customerContactPhone"
						[class.is-invalid]="
              IncidentReport.get('customerContactPhone')?.hasError(
                'required'
              ) &&
              (IncidentReport.get('customerContactPhone').dirty ||
                IncidentReport.get('customerContactPhone').touched)
            "
					/>
					<label class="cols" class="form-Label"
						>Customer Contact Phone<span class="text-danger"
							>*</span
						></label
					>
					<span
						*ngIf="
              IncidentReport.get('customerContactPhone')?.hasError(
                'required'
              ) &&
              (IncidentReport.get('customerContactPhone').dirty ||
                IncidentReport.get('customerContactPhone').touched)
            "
						class="invalid-feedback"
					>
						Phone Number is Required</span
					>
				</div>
			</div>

			<div class="col-md-6 col-sm-6-print">
				<div class="form-floating">
					<input
						placeholder="ex: email@yahoo.com"
						type="text"
						placeholder="dd"
						class="form-control"
						formControlName="customerEmail"
						[class.is-invalid]="
              IncidentReport.get('customerEmail')?.hasError('required') &&
              (IncidentReport.get('customerEmail').dirty ||
                IncidentReport.get('customerEmail').touched)
            "
					/>
					<label class="cols" class="form-Label"
						>Customer Contact Email<span class="text-danger"
							>*</span
						></label
					>
					<span
						*ngIf="
              IncidentReport.get('customerEmail')?.hasError('required') &&
              (IncidentReport.get('customerEmail').dirty ||
                IncidentReport.get('customerEmail').touched)
            "
						class="invalid-feedback"
					>
						Email is Required</span
					>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-sm-6-print form-floating">
				<input
					matInput
					[matDatepicker]="datepicker"
					[max]="maxDate"
					placeholder="dd"
					[min]="minDate"
					class="form-control"
					formControlName="dateOfFormCompletion"
					[class.is-invalid-date]="IncidentReport.get('dateOfFormCompletion')?.hasError('required') && (IncidentReport.get('dateOfFormCompletion').dirty || IncidentReport.get('dateOfFormCompletion').touched) "
					placeholder="dd-mm-yyyy"
				/>
				<label class="cols" class="form-Label"
					>Date of Form Completion<span class="text-danger"
						>*</span
					></label
				>
				<mat-datepicker-toggle
					matSuffix
					[for]="datepicker"
				></mat-datepicker-toggle>
				<mat-datepicker #datepicker></mat-datepicker>
				<!--  -->
				<span
					*ngIf=" IncidentReport.get('dateOfFormCompletion')?.hasError('required') && (IncidentReport.get('dateOfFormCompletion').dirty  || IncidentReport.get('dateOfFormCompletion').touched) "
					class="invalid-feedback1 date-valid"
				>
					Date is Required</span
				>
			</div>
		</div>
	</div>
	<hr />
	<div class="col-12" class="mt-3">
		<p class="title">Type of Incident</p>
	</div>
	<div class="row">
		<ng-container formArrayName="incidents">
			<ng-container
				*ngFor="let control of incidentsAdd().controls; let i = index"
				[formGroupName]="i"
			>
				<div class="mt-2 col-sm-4">
					<div class="checkrdobtn ml-3">
						<input
							class="rdovstchk"
							[id]="i + 'typeOf'"
							class="mr-1"
							type="checkbox"
							[value]="incidents[i]._id"
							(change)="typeOfIncidentsSelected($event)"
							formControlName="{{ incidents[i]._id }}"
						/>
						<label
							class="txtdefault fs-16 weight500 text-center label_2"
							[for]="i + 'typeOf'"
							>{{ incidents[i].title }}</label
						>
					</div>
				</div>
			</ng-container>
		</ng-container>
	</div>

	<hr />
	<div class="row">
		<div class="col-md-12">
			<p class="title">Instructions</p>

			<div class="mt-3 text-center">
				<ckeditor
					[disabled]="true"
					formControlName="instructions"
					style="width: 100%"
					[editor]="Editor"
					[config]="{ toolbar: [  ] }"
				></ckeditor>
			</div>
		</div>
	</div>
	<br />
	<hr />
	<div class="col-12">
		<p class="title">Injured or Affected Person</p>
	</div>
	<div class="box" class="row">
		<div class="col-md-6 col-sm-6-print">
			<div>
				<label class="cols" class="form-Label"
					>Name<span class="text-danger">*</span></label
				>
				<input
					type="text"
					class="form-control"
					formControlName="name"
					[matAutocomplete]="injuredorAffectedPersonName"
					[class.is-invalid]="
            IncidentReport.get('name')?.hasError('required') &&
            (IncidentReport.get('name').dirty ||
              IncidentReport.get('name').touched)
          "
				/>
				<mat-autocomplete
					#injuredorAffectedPersonName="matAutocomplete"
					(optionSelected)="employeeData($event,'injuredorAffectedPersonName')"
					[displayWith]="displayFn"
				>
					<mat-option
						*ngFor="let option of injuredorAffectedPersonName$ | async ; let i = index "
						[value]="option"
					>
						{{option.fullName}}
					</mat-option>
				</mat-autocomplete>
				<span
					*ngIf="
            IncidentReport.get('name')?.hasError('required') &&
            (IncidentReport.get('name').dirty ||
              IncidentReport.get('name').touched)
          "
					class="invalid-feedback"
				>
					Name is Required</span
				>
			</div>
		</div>
		<div class="col-md-6 col-sm-6-print">
			<div>
				<label class="cols" class="form-Label"
					>Department<span class="text-danger">*</span></label
				>
				<input
					type="text"
					[matAutocomplete]="department"
					class="form-control"
					formControlName="department"
					[class.is-invalid]="
            IncidentReport.get('department')?.hasError('required') &&
            (IncidentReport.get('department').dirty ||
              IncidentReport.get('department').touched)
          "
				/>
				<mat-autocomplete
					#department="matAutocomplete"
					[displayWith]="displayFnDepartmentName"
				>
					<mat-option
						*ngFor="let option of department$ | async ; let i = index "
						[value]="option"
					>
						{{option.departmentName}}
					</mat-option>
				</mat-autocomplete>
				<span
					*ngIf="
            IncidentReport.get('department')?.hasError('required') &&
            (IncidentReport.get('department').dirty ||
              IncidentReport.get('department').touched)
          "
					class="invalid-feedback"
				>
					This Field is Required</span
				>
			</div>
		</div>
	</div>
	<div class="box" class="row">
		<div class="col-md-6 col-sm-6-print">
			<div>
				<label class="cols" class="form-Label"
					>position<span class="text-danger">*</span></label
				>
				<input
					type="text"
					[matAutocomplete]="position"
					class="form-control"
					formControlName="position"
					[class.is-invalid]="
            IncidentReport.get('position')?.hasError('required') &&
            (IncidentReport.get('position').dirty ||
              IncidentReport.get('position').touched)
          "
				/>
				<span
					*ngIf="
            IncidentReport.get('position')?.hasError('required') &&
            (IncidentReport.get('position').dirty ||
              IncidentReport.get('position').touched)
          "
					class="invalid-feedback"
				>
					This Field is Required</span
				>
				<mat-autocomplete
					[displayWith]="displayFnRole"
					#position="matAutocomplete"
				>
					<mat-option
						*ngFor="let item of position$ | async as list"
						[value]="item"
						>{{item.role}}</mat-option
					>
				</mat-autocomplete>
			</div>
		</div>
	</div>
	<hr />
	<div class="col-12 pagebreak-print">
		<p class="title">Nature of Incident</p>
	</div>
	<div class="box" class="row">
		<ng-container formArrayName="natureOFIncidents">
			<ng-container
				*ngFor="let control of natureAdd().controls; let i = index"
				[formGroupName]="i"
			>
				<div class="mt-3 col-sm-4">
					<div class="checkrdobtn ml-3">
						<input
							class="rdovstchk"
							[id]="i + 'natureOfInc'"
							type="checkbox"
							class="mr-1"
							[value]="natureOFIncidents[i]._id"
							(change)="natureOfIncSelected($event)"
							formControlName="{{ natureOFIncidents[i]._id }}"
						/>
						<label
							class="txtdefault fs-16 weight500 text-center label_2"
							[for]="i + 'natureOfInc'"
							>{{ natureOFIncidents[i].title }}</label
						>
					</div>
				</div>
			</ng-container>
		</ng-container>
	</div>
	<hr />
	<div class="box" class="row">
		<div class="col-md-6 col-sm-6-print">
			<div>
				<label class="form-Label"
					>Location of the incident<span class="text-danger"
						>*</span
					></label
				>
				<input
					type="text"
					class="form-control"
					formControlName="locationOfTheIncident"
					[class.is-invalid]="
            IncidentReport.get('locationOfTheIncident')?.hasError('required') &&
            (IncidentReport.get('locationOfTheIncident').dirty ||
              IncidentReport.get('locationOfTheIncident').touched)
          "
				/>
				<span
					*ngIf="
            IncidentReport.get('locationOfTheIncident')?.hasError('required') &&
            (IncidentReport.get('locationOfTheIncident').dirty ||
              IncidentReport.get('locationOfTheIncident').touched)
          "
					class="invalid-feedback"
				>
					Locationis Required</span
				>
			</div>
		</div>
		<div class="col-md-3 col-md-3-print">
			<div>
				<label class="form-Label mt-2"
					>Date of the incident<span class="text-danger"
						>*</span
					></label
				>
				<input
					matInput
					[matDatepicker]="picker"
					[max]="maxDate"
					class="form-control"
					placeholder="dd-mm-yyyy"
					formControlName="dateOfTheIncident"
					[class.is-invalid-date]="IncidentReport.get('dateOfTheIncident')?.hasError('required')
        && (IncidentReport.get('dateOfTheIncident').dirty
        || IncidentReport.get('dateOfTheIncident').touched) "
				/>
				<mat-datepicker-toggle
					matSuffix
					[for]="picker"
				></mat-datepicker-toggle>
				<mat-datepicker #picker></mat-datepicker>
				<!--  -->
				<span
					*ngIf=" IncidentReport.get('dateOfTheIncident')?.hasError('required') && (IncidentReport.get('dateOfTheIncident').dirty  || IncidentReport.get('dateOfTheIncident').touched) "
					class="invalid-feedback1 date-valid"
				>
					Date is Required</span
				>
			</div>
		</div>
		<div class="col-md-3 col-md-3-print">
			<div>
				<label class="cols" class="form-Label"
					>Time of the incident<span class="text-danger"
						>*</span
					></label
				>
				<input
					[ngxMatTimepicker]="timepicker"
					class="form-control"
					formControlName="timeOfTheIncident"
					[class.is-invalid]="IncidentReport.get('timeOfTheIncident')?.hasError('required') && (IncidentReport.get('timeOfTheIncident').dirty || IncidentReport.get('timeOfTheIncident').touched) "
				/>

				<ngx-mat-timepicker #timepicker></ngx-mat-timepicker>
				<span
					*ngIf=" IncidentReport.get('timeOfTheIncident')?.hasError('required') && (IncidentReport.get('timeOfTheIncident').dirty  || IncidentReport.get('timeOfTheIncident').touched) "
					class="invalid-feedback"
				>
					Select Time is Required</span
				>
			</div>
		</div>
	</div>
	<br />
	<div class="col-12">
		<p class="title">Incident Information</p>
	</div>
	<div class="box" class="row">
		<div class="col-md-6 col-sm-6-print">
			<div>
				<label class="cols" class="form-Label">
					Name of Witness<span class="text-danger">*</span></label
				>
				<input
					type="text"
					class="form-control"
					formControlName="nameOfWitness"
					[class.is-invalid]="
            IncidentReport.get('nameOfWitness')?.hasError('required') &&
            (IncidentReport.get('nameOfWitness').dirty ||
              IncidentReport.get('nameOfWitness').touched)
          "
				/>
				<span
					*ngIf="
            IncidentReport.get('nameOfWitness')?.hasError('required') &&
            (IncidentReport.get('nameOfWitness').dirty ||
              IncidentReport.get('nameOfWitness').touched)
          "
					class="invalid-feedback"
				>
					Name is Required</span
				>
			</div>
		</div>

		<div class="col-md-6 col-sm-6-print">
			<div>
				<label class="cols" class="form-Label"
					>Witness Statement<span class="text-danger">*</span></label
				>
				<textarea
					type="text"
					rows="4"
					class="form-control txt-auto"
					cdkTextareaAutosize
					#autosize="cdkTextareaAutosize"
					cdkAutosizeMinRows="1.5"
					cdkAutosizeMaxRows="5"
					formControlName="witnessStatement"
					[class.is-invalid]="
            IncidentReport.get('witnessStatement')?.hasError('required') &&
            (IncidentReport.get('witnessStatement').dirty ||
              IncidentReport.get('witnessStatement').touched)
          "
				>
				</textarea>
				<span
					*ngIf="
            IncidentReport.get('witnessStatement')?.hasError('required') &&
            (IncidentReport.get('witnessStatement').dirty ||
              IncidentReport.get('witnessStatement').touched)
          "
					class="invalid-feedback"
				>
					This Field is Required</span
				>
			</div>
		</div>
	</div>
	<div class="box" class="row">
		<div
			class="col-md-12"
			*ngIf="(isPrint | async)===true?false:isHistory===true?false:true"
		>
			<div>
				<label class="form-Label">Attachments </label>
				<input
					class="form-control"
					type="file"
					(change)="browser($event)"
					accept="image/*"
				/>
			</div>
		</div>
		<div class="my-3 col-md-12">
			<label for="formFile" class="form-label">Uploaded File List</label>
			<span class="form-control"> {{uploadFile}} </span>
		</div>
	</div>
	<br />

	<div class="col-12">
		<p class="title">What PPE was in Use ?</p>
	</div>
	<div class="box" class="row">
		<ng-container formArrayName="PPE">
			<ng-container
				*ngFor="let control of ppeAdd().controls; let i = index"
				[formGroupName]="i"
			>
				<div class="mt-2 col-sm-4">
					<div class="checkrdobtn ml-3 ppeCheck">
						<input
							class="rdovstchk"
							[id]="i + 'whatPPE'"
							type="checkbox"
							class="mr-1"
							[value]="PPE[i]._id"
							(change)="ppeSelected($event)"
							formControlName="{{ PPE[i]._id }}"
						/>
						<label
							class="txtdefault fs-16 weight500 text-center label_2 disp-itm"
							[class.text-center]="!(mobileViewService.isMobile| async)"
							[for]="i + 'whatPPE'"
							>{{ PPE[i].title }}</label
						>
					</div>
				</div>
			</ng-container>
		</ng-container>
	</div>
	<br />
	<hr />
	<div class="col-12">
		<p class="title">What was the rootcause of incident happen?</p>
	</div>
	<div class="box" class="row">
		<ng-container formArrayName="rootCauseIncident">
			<ng-container
				*ngFor="let control of rootCauseIncidentAdd().controls; let i = index"
				[formGroupName]="i"
			>
				<div class="mt-2 col-sm-4">
					<div class="checkrdobtn ml-3">
						<input
							class="rdovstchk"
							[id]="i + 'rootCauseIncident'"
							type="checkbox"
							class="mr-1"
							[value]="rootCauseIncident[i]._id"
							(change)="rootSelected($event)"
							formControlName="{{ rootCauseIncident[i]._id }}"
						/>
						<label
							class="txtdefault fs-16 weight500 text-center label_2"
							[for]="i + 'rootCauseIncident'"
							>{{ rootCauseIncident[i].title }}</label
						>
					</div>
				</div>
			</ng-container>
		</ng-container>
	</div>
	<br />

	<div class="row">
		<div class="col-md-12">
			<div>
				<label class="cols" class="form-Label"
					>Why did the unsafe condition exist</label
				>

				<textarea
					type="text"
					formControlName="whyDidtheUnsafeConditonExist"
					class="form-control"
				>
				</textarea>
			</div>
		</div>

		<div class="col-md-6 col-sm-6-print">
			<label
				class="cols"
				for="exampleFormControlInput1"
				class="form-Label"
				>Was the unsafe act or hazard reported prior to the
				incident?</label
			>

			<select
				class="form-select form-control col form-dropdown"
				formControlName="priorIncident"
				aria-label="Default select example"
			>
				<option selected hidden>Select</option>
				<option value="yes">Yes</option>
				<option value="no">No</option>
			</select>
			<div *ngIf="IncidentReport.get('priorIncident').value == 'yes'">
				<label class="mb-2"> Please Describe </label>
				<textarea
					name=""
					class="col form-control"
					id=""
					formControlName="priorIncidentText"
				></textarea>
			</div>
		</div>

		<div class="col-md-6 col-sm-6-print">
			<label
				class="cols"
				for="exampleFormControlInput1"
				class="form-Label"
				>Has a similar incident Occured</label
			>

			<select
				class="form-select form-control col form-dropdown"
				formControlName="similarIncident"
				aria-label="Default select example"
			>
				<option selected hidden>Select</option>
				<option value="yes">Yes</option>
				<option value="no">No</option>
			</select>
			<div *ngIf="IncidentReport.get('similarIncident').value == 'yes'">
				<label class="mb-2"> Please Describe </label>
				<textarea
					name=""
					class="col form-control"
					id=""
					formControlName="similarIncidentText"
				></textarea>
			</div>
		</div>
	</div>

	<hr />
	<br />
	<div class="col-12">
		<p class="title">What changes can be made ?</p>
	</div>
	<div class="row">
		<ng-container formArrayName="changes">
			<ng-container
				*ngFor="
          let control of changeAdd().controls;
          let i = index;

        "
				[formGroupName]="i"
			>
				<div class="mt-2 col-sm-4 mb-0">
					<div class="checkrdobtn ml-3">
						<ng-container>
							<input
								class="rdovstchk"
								[id]="i + 'changes'"
								type="checkbox"
								class="mr-1"
								(change)="changesSelected($event,i)"
								formControlName="{{ changes[i]._id }}"
							/>

							<label
								class="txtdefault fs-16 weight500 text-center label_2"
								[for]="i + 'changes'"
								>{{ changes[i].title }}
							</label>
						</ng-container>
					</div>
				</div>
				<ng-container> </ng-container>
			</ng-container>
		</ng-container>
		<ng-container class="mt-2 col-4 mb-0">
			<div class="checkrdobtn ml-4">
				<input
					class="rdovstchk"
					id="other"
					type="checkbox"
					class="mr-1"
					(change)="changesSelected($event,'')"
					formControlName="changesMadeOther"
				/>

				<label
					class="txtdefault fs-16 weight500 text-center label_2"
					for="other"
				>
					Other
				</label>
				<textarea
					*ngIf="IncidentReport.get('changesMadeOther').value"
					type="text"
					class="form-control txt-auto"
					cdkTextareaAutosize
					#autosize="cdkTextareaAutosize"
					cdkAutosizeMinRows="1.5"
					cdkAutosizeMaxRows="5"
					formControlName="changesMadeOtherText"
				>
				</textarea>
			</div>
		</ng-container>
	</div>
	<hr />
	<div class="box" class="row">
		<ng-container formArrayName="corrAction">
			<ng-container
				*ngFor="let control of add().controls; let i = index"
				[formGroupName]="i"
			>
				<div class="col-md-3 col-md-3-print">
					<div>
						<label class="cols" class="form-Label"
							>Corrective Action<span class="text-danger"
								>*</span
							></label
						>

						<textarea
							type="text"
							formControlName="action"
							class="form-control"
							[class.is-invalid]="
                add().controls[i].get('action')?.hasError('required') &&
                (add().controls[i].get('action').dirty ||
                  add().controls[i].get('action').touched)
              "
						></textarea>
						<span
							*ngIf="
                add().controls[i].get('action')?.hasError('required') &&
                (add().controls[i].get('action').dirty ||
                  add().controls[i].get('action').touched)
              "
							class="invalid-feedback"
						>
							This Field is Required</span
						>
					</div>
				</div>
				<div class="col-md-3 col-md-3-print">
					<div>
						<label class="cols" class="form-Label"
							>Person Responsible<span class="text-danger"
								>*</span
							></label
						>

						<select
							class="form-select form-control col form-dropdown"
							aria-label="Default select example"
							formControlName="personRes"
							[class.is-invalid]="
                add().controls[i].get('personRes')?.hasError('required') &&
                (add().controls[i].get('personRes').dirty ||
                  add().controls[i].get('personRes').touched)
              "
						>
							<option selected hidden>Select...</option>
							<option *ngFor="let j of staff" [value]="j?._id">
								{{ j?.fullName }}
							</option>
						</select>
						<span
							*ngIf="
                add().controls[i].get('personRes')?.hasError('required') &&
                (add().controls[i].get('personRes').dirty ||
                  add().controls[i].get('personRes').touched)
              "
							class="invalid-feedback"
						>
							This Field is Required</span
						>
					</div>
				</div>
				<div class="col-md-2 col-md-2-print">
					<label class="cols" class="form-Label"
						>Completed by Date<span class="text-danger">*</span>
					</label>
					<input
						matInput
						[matDatepicker]="pickerd4"
						[min]="minDate"
						class="form-control"
						formControlName="date"
						placeholder="dd-mm-yyyy"
						[class.is-invalid-date]=" add().controls[i].get('date')?.hasError('required') && (add().controls[i].get('date').dirty || add().controls[i].get('date').touched) "
					/>
					<mat-datepicker-toggle
						matSuffix
						[for]="pickerd4"
					></mat-datepicker-toggle>
					<mat-datepicker #pickerd4></mat-datepicker>
					<span
						*ngIf=" add().controls[i].get('date')?.hasError('required') && (add().controls[i].get('date').dirty  || add().controls[i].get('date').touched) "
						class="invalid-feedback1"
					>
						Date is Required</span
					>
				</div>
				<div
					class="col-1 mt-5"
					*ngIf="(isPrint | async)===true?false:isHistory===true?false:true"
				>
					<span class="material-icons" (click)="addAction()"
						>add_circle_outline
					</span>
				</div>
				<div
					class="col-1 mt-5"
					*ngIf="(isPrint | async)===true?false:isHistory===true?false:true"
				>
					<span class="material-icons" (click)="removeIncident(i)">
						remove_circle_outline
					</span>
				</div>
			</ng-container>
		</ng-container>
	</div>
	<hr />
	<div class="col-12">
		<p class="title">The form was completed by:</p>
	</div>
	<div>
		<div class="box" class="row">
			<div class="col-md-6 col-sm-6-print">
				<div>
					<label class="cols" class="form-Label"
						>Name<span class="text-danger">*</span></label
					>
					<input
						type="text"
						[matAutocomplete]="employee1"
						autocomplete="off"
						class="form-control"
						formControlName="completedName"
						[class.is-invalid]="
              IncidentReport.get('completedName')?.hasError('required') &&
              (IncidentReport.get('completedName').dirty ||
                IncidentReport.get('completedName').touched)
            "
					/>
					<mat-autocomplete
						#employee1="matAutocomplete"
						(optionSelected)="employeeData($event,'completedName')"
						[displayWith]="displayFn"
					>
						<mat-option
							*ngFor="let option of filteredOptions1 | async ; let i = index "
							[value]="option"
						>
							{{option.fullName}}
						</mat-option>
					</mat-autocomplete>
					<span
						*ngIf="
              IncidentReport.get('completedName')?.hasError('required') &&
              (IncidentReport.get('completedName').dirty ||
                IncidentReport.get('completedName').touched)
            "
						class="invalid-feedback"
					>
						Name is Required</span
					>
				</div>
			</div>

			<div class="col-md-6 col-sm-6-print">
				<div>
					<label class="cols" class="form-Label"
						>Position<span class="text-danger">*</span>
					</label>
					<input
						type="text"
						[matAutocomplete]="completedPosition"
						class="form-control"
						formControlName="completedPosition"
						[class.is-invalid]="
              IncidentReport.get('completedPosition')?.hasError('required') &&
              (IncidentReport.get('completedPosition').dirty ||
                IncidentReport.get('completedPosition').touched)
            "
					/>
					<span
						*ngIf="
              IncidentReport.get('completedPosition')?.hasError('required') &&
              (IncidentReport.get('completedPosition').dirty ||
                IncidentReport.get('completedPosition').touched)
            "
						class="invalid-feedback"
					>
						This Field is Required</span
					>
					<mat-autocomplete
						[displayWith]="displayFnRole"
						#completedPosition="matAutocomplete"
					>
						<mat-option
							*ngFor="let item of completedPosition$ | async as list"
							[value]="item"
							>{{item.role}}</mat-option
						>
					</mat-autocomplete>
				</div>
			</div>
		</div>
		<div class="box" class="row">
			<div class="col-md-6 col-sm-6-print">
				<div>
					<label class="cols" class="form-Label"
						>Department<span class="text-danger">*</span></label
					>
					<input
						type="text"
						[matAutocomplete]="completedDepartment"
						class="form-control"
						formControlName="completedDepartment"
						[class.is-invalid]="
              IncidentReport.get('completedDepartment')?.hasError('required') &&
              (IncidentReport.get('completedDepartment').dirty ||
                IncidentReport.get('completedDepartment').touched)
            "
					/>
					<mat-autocomplete
						#completedDepartment="matAutocomplete"
						[displayWith]="displayFnDepartmentName"
					>
						<mat-option
							*ngFor="let option of completedDepartment$ | async ; let i = index "
							[value]="option"
						>
							{{option.departmentName}}
						</mat-option>
					</mat-autocomplete>
					<span
						*ngIf="
              IncidentReport.get('completedDepartment')?.hasError('required') &&
              (IncidentReport.get('completedDepartment').dirty ||
                IncidentReport.get('completedDepartment').touched)
            "
						class="invalid-feedback"
					>
						This Field is Required</span
					>
				</div>
			</div>

			<div class="col-md-6 col-sm-6-print">
				<div>
					<label class="cols" class="form-Label"
						>Date <span class="text-danger">*</span></label
					>
					<!-- <input type="date" class="form-control" formControlName="completedDate" [class.is-invalid]="IncidentReport.get('completedDate')?.hasError('required') && (IncidentReport.get('completedDate').dirty || IncidentReport.get('completedDate').touched) "/> -->
					<input
						matInput
						[matDatepicker]="pickerd5"
						[max]="maxDate"
						class="form-control"
						formControlName="completedDate"
						[class.is-invalid-date]="IncidentReport.get('completedDate')?.hasError('required') && (IncidentReport.get('completedDate').dirty || IncidentReport.get('completedDate').touched) "
						placeholder="dd-mm-yyyy"
					/>
					<mat-datepicker-toggle
						matSuffix
						[for]="pickerd5"
					></mat-datepicker-toggle>
					<mat-datepicker #pickerd5></mat-datepicker>
					<span
						*ngIf=" IncidentReport.get('completedDate')?.hasError('required') && (IncidentReport.get('completedDate').dirty  || IncidentReport.get('completedDate').touched) "
						class="invalid-feedback1"
					>
						Date is Required</span
					>
				</div>
			</div>
		</div>
		<div class="row">
			<div class="col-md-6 col-sm-6-print">
				<div>
					<label class="cols" class="form-Label"
						>Signature<span class="text-danger">*</span></label
					>
					<div class="sign">
						<signature-pad
							[options]="signaturePadOptions"
							(onBeginEvent)="drawStart()"
							(onEndEvent)="drawComplete()"
							#signature
							[class.is-invalid]="singRequired"
						>
						</signature-pad>
						<span *ngIf="singRequired" class="invalid-feedback">
							This Field is Required</span
						>
					</div>
					<button
						*ngIf="(isPrint | async)===true?false:isHistory===true?false:true"
						class="btn btn-outline-primary mt-1"
						(click)="clear()"
					>
						Clear
					</button>
				</div>
			</div>
		</div>
	</div>
	<br />
	<div class="pagebreak-print">
		<p class="title">The Form was Reviewed by:</p>
		<div>
			<div class="box" class="row">
				<div class="col-md-6 col-sm-6-print">
					<div>
						<label class="cols" class="form-Label"
							>Name<span class="text-danger">*</span></label
						>
						<input
							type="text"
							class="form-control"
							formControlName="reviewedName"
							[matAutocomplete]="employee2"
							autocomplete="off"
							[class.is-invalid]="
              IncidentReport.get('reviewedName')?.hasError('required') &&
              (IncidentReport.get('reviewedName').dirty ||
                IncidentReport.get('reviewedName').touched)
            "
						/>
						<mat-autocomplete
							#employee2="matAutocomplete"
							(optionSelected)="employeeData($event,'reviewedName')"
							[displayWith]="displayFn"
						>
							<mat-option
								*ngFor="let option of filteredOptions2 | async ; let i = index "
								[value]="option"
							>
								{{option.fullName}}
							</mat-option>
						</mat-autocomplete>
						<span
							*ngIf="
              IncidentReport.get('reviewedName')?.hasError('required') &&
              (IncidentReport.get('reviewedName').dirty ||
                IncidentReport.get('reviewedName').touched)
            "
							class="invalid-feedback"
						>
							Name is Required</span
						>
					</div>
				</div>

				<div class="col-md-6 col-sm-6-print">
					<div>
						<label class="cols" class="form-Label"
							>Position <span class="text-danger">*</span></label
						>
						<input
							type="text"
							[matAutocomplete]="reviewedPosition"
							class="form-control"
							formControlName="reviewedPosition"
							[class.is-invalid]="
              IncidentReport.get('reviewedPosition')?.hasError('required') &&
              (IncidentReport.get('reviewedPosition').dirty ||
                IncidentReport.get('reviewedPosition').touched)
            "
						/>
						<span
							*ngIf="
              IncidentReport.get('reviewedPosition')?.hasError('required') &&
              (IncidentReport.get('reviewedPosition').dirty ||
                IncidentReport.get('reviewedPosition').touched)
            "
							class="invalid-feedback"
						>
							This Field is Required</span
						>
						<mat-autocomplete
							[displayWith]="displayFnRole"
							#reviewedPosition="matAutocomplete"
						>
							<mat-option
								*ngFor="let item of reviewedPosition$ | async as list"
								[value]="item"
								>{{item.role}}</mat-option
							>
						</mat-autocomplete>
					</div>
				</div>
			</div>
			<div class="box" class="row">
				<div class="col-md-6 col-sm-6-print">
					<div>
						<label class="cols" class="form-Label"
							>Department<span class="text-danger">*</span></label
						>
						<input
							type="text"
							[matAutocomplete]="reviewedDepartment"
							class="form-control"
							formControlName="reviewedDepartment"
							[class.is-invalid]="
              IncidentReport.get('reviewedDepartment')?.hasError('required') &&
              (IncidentReport.get('reviewedDepartment').dirty ||
                IncidentReport.get('reviewedDepartment').touched)
            "
						/>
						<mat-autocomplete
							#reviewedDepartment="matAutocomplete"
							[displayWith]="displayFnDepartmentName"
						>
							<mat-option
								*ngFor="let option of reviewedDepartment$ | async ; let i = index "
								[value]="option"
							>
								{{option.departmentName}}
							</mat-option>
						</mat-autocomplete>
						<span
							*ngIf="
              IncidentReport.get('reviewedDepartment')?.hasError('required') &&
              (IncidentReport.get('reviewedDepartment').dirty ||
                IncidentReport.get('reviewedDepartment').touched)
            "
							class="invalid-feedback"
						>
							This Field is Required</span
						>
					</div>
				</div>

				<div class="col-md-6 col-sm-6-print">
					<div>
						<label class="cols" class="form-Label"
							>Date <span class="text-danger">*</span></label
						>
						<!-- <input type="date" class="form-control" formControlName="reviewedDate" [class.is-invalid]="IncidentReport.get('reviewedDate')?.hasError('required') && (IncidentReport.get('reviewedDate').dirty || IncidentReport.get('reviewedDate').touched) "/> -->
						<input
							matInput
							[matDatepicker]="pickerd6"
							[max]="maxDate"
							class="form-control"
							formControlName="reviewedDate"
							[class.is-invalid-date]="IncidentReport.get('reviewedDate')?.hasError('required') && (IncidentReport.get('reviewedDate').dirty || IncidentReport.get('reviewedDate').touched) "
							placeholder="dd-mm-yyyy"
						/>
						<mat-datepicker-toggle
							matSuffix
							[for]="pickerd6"
						></mat-datepicker-toggle>
						<mat-datepicker #pickerd6></mat-datepicker>
						<span
							*ngIf=" IncidentReport.get('reviewedDate')?.hasError('required') && (IncidentReport.get('reviewedDate').dirty  || IncidentReport.get('reviewedDate').touched) "
							class="invalid-feedback1"
						>
							Date is Required</span
						>
					</div>
				</div>
			</div>
			<div class="box" class="row">
				<div class="col-md-6 col-sm-6-print">
					<div>
						<label class="cols" class="form-Label"
							>Signature<span class="text-danger">*</span></label
						>
						<div class="sign">
							<signature-pad
								[options]="signaturePadOptions1"
								(onBeginEvent)="drawStart1()"
								(onEndEvent)="drawComplete1()"
								#signature1
								[class.is-invalid]="singRequired1"
							></signature-pad>
							<span
								*ngIf="singRequired1"
								class="invalid-feedback"
							>
								This Field is Required</span
							>
						</div>
						<button
							*ngIf="(isPrint | async)===true?false:isHistory===true?false:true"
							class="btn btn-outline-primary mt-1"
							(click)="clear1()"
						>
							Clear
						</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<hr />

	<br />

	<div class="col-md-2 col-sm-2-print">
		<button
			*ngIf="(isPrint | async)===true?false:isHistory===true?false:true"
			type="submit"
			class="btn btn-primary btn-block"
			(click)="onSubmit()"
		>
			Submit
		</button>
	</div>

	<ng-container *ngIf="isImg">
		<div
			style="padding-left: 30%"
			*ngIf="(isPrint | async)===true && selectedImage"
		>
			<span>
				<div>
					<img height="400" width="400" [src]="selectedImage" />
				</div>
			</span>
		</div>
	</ng-container>
</div>
